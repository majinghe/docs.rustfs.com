# 文档管理脚本

本目录包含用于管理多语言文档的工具脚本。

## 脚本列表

### 1. sync-docs.js - 文档同步工具

用于将中文文档结构和内容同步到其他语言版本。

**功能特性：**

- 自动创建与中文版本一致的目录结构
- 智能处理文件更新（基于行数差异和时间戳）
- 自动清理目标语言中的多余文件
- 为新文件创建"待翻译"占位符

**使用方法：**

```bash
# 同步所有语言
npm run sync

# 同步特定语言
npm run sync:ko    # 韩语
npm run sync:en    # 英语
npm run sync:de    # 德语
# ... 其他语言类似
```

**工作原理：**

- 以 `docs/zh/` 为源
- 行数差异超过 5 行时重置为待翻译
- 时间戳更新时重置为待翻译
- 自动跳过 `config.ts`、`sidebar.ts` 等配置文件
- 占位符中的链接会动态计算相对路径

### 2. update-todo.js - 待翻译任务列表生成器

为每个语言目录生成 todo.md 文件，列出所有待翻译的文档。

**功能特性：**

- 自动识别含有待翻译标记的文件
- 在每个语言目录下生成 todo.md
- 按目录分组展示待翻译文件
- 提供可点击的文件链接和行数统计

**使用方法：**

```bash
# 更新所有语言的 todo.md
npm run todo

# 更新特定语言的 todo.md
npm run todo:ko    # 韩语
npm run todo:en    # 英语
# ... 其他语言类似
```

**生成的 todo.md 包含：**

- 待翻译文件总数统计
- 按目录分组的任务列表
- 每个文件的可点击链接
- 源文件行数（用于评估工作量）
- 任务复选框（方便标记进度）

## 支持的语言

- `de` - 德语
- `en` - 英语
- `es` - 西班牙语
- `fr` - 法语
- `ja` - 日语
- `ko` - 韩语
- `pt` - 葡萄牙语
- `ru` - 俄语
- `tr` - 土耳其语

## 典型工作流程

### 1. 初始同步

```bash
npm run sync:ko        # 同步韩语文档结构
```

### 2. 生成待翻译列表

```bash
npm run todo:ko        # 生成韩语的 todo.md
```

### 3. 查看任务清单

打开 `docs/ko/todo.md` 查看待翻译文件列表，文件中包含：

- 可点击的文件链接
- 源文件行数统计
- 任务复选框

### 4. 翻译后更新

```bash
npm run todo:ko        # 重新生成 todo.md，查看剩余任务
```

## 配置说明

两个脚本都使用以下配置：

- **源语言目录**：`docs/zh/`
- **目标语言目录**：`docs/{语言代码}/`
- **行数差异阈值**：5 行（sync-docs.js）
- **扫描深度**：前 20 行（update-todo.js）
- **生成文件**：`docs/{语言代码}/todo.md`

## 注意事项

1. **同步操作会覆盖文件**：当检测到需要更新时，sync-docs.js 会用占位符覆盖现有文件
2. **保护已翻译内容**：行数差异在 5 行以内且时间戳一致的文件会被保留
3. **自动清理**：目标语言中不存在于中文版本的文件会被删除
4. **配置文件安全**：`config.ts` 和 `sidebar.ts` 永远不会被同步或删除

## 故障排除

### sync-docs.js 相关

- **中文文档目录不存在**：确保 `docs/zh/` 目录存在
- **权限问题**：确保有读写 `docs/` 目录的权限

### list-pending-translations.js 相关

- **找不到待翻译文件**：检查文件是否包含正确的待翻译标记
- **语言目录不存在**：确保指定的语言代码正确

## 开发说明

### 直接运行脚本

```bash
# 同步
node scripts/sync-docs.js [语言代码...]

# 扫描
node scripts/list-pending-translations.js [语言代码...] [--json] [--details]
```

### 添加新语言

1. 在 `docs/` 下创建新的语言目录
2. 复制 `config.ts` 和 `sidebar.ts` 到新目录
3. 运行 `npm run sync:{语言代码}` 初始化结构
4. 更新 `package.json` 添加对应的 npm scripts

## 维护建议

1. **定期同步**：每次更新中文文档后运行同步
2. **批量翻译**：使用 `pending:json` 导出任务分配给翻译团队
3. **版本控制**：同步和翻译操作后及时提交变更
4. **进度跟踪**：定期运行 `pending` 命令监控翻译进度
