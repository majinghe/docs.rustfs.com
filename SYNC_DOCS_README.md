# 文档同步工具说明

## 功能介绍

`sync-docs.js` 是一个用于同步中文文档到其他语言版本的 Node.js 脚本。它可以：

1. **自动创建文档结构**：为目标语言创建与中文版本完全一致的目录结构
2. **智能文件处理**：
   - 非 Markdown 文件（如图片、SVG等）直接复制
   - 新的 Markdown 文件创建占位符内容（标记为"待翻译"）
   - 已存在的文件根据更新时间判断是否需要更新
3. **自动清理多余文件**：删除目标语言中存在但中文版本中不存在的文件和目录
4. **时间戳比较**：通过比较文件修改时间，识别需要更新翻译的文件
5. **详细统计**：提供同步操作的详细统计信息

## 使用方法

### 使用 npm scripts（推荐）

```bash
# 同步所有语言
npm run sync
# 或
npm run sync:all

# 同步特定语言
npm run sync:ko    # 韩语
npm run sync:en    # 英语
npm run sync:de    # 德语
npm run sync:es    # 西班牙语
npm run sync:fr    # 法语
npm run sync:ja    # 日语
npm run sync:pt    # 葡萄牙语
npm run sync:ru    # 俄语
npm run sync:tr    # 土耳其语
```

### 直接运行脚本

```bash
# 同步所有语言
node sync-docs.js

# 同步单个语言
node sync-docs.js ko

# 同步多个语言
node sync-docs.js en fr de
```

### 支持的语言代码

- `de` - 德语
- `en` - 英语
- `es` - 西班牙语
- `fr` - 法语
- `ja` - 日语
- `ko` - 韩语
- `pt` - 葡萄牙语
- `ru` - 俄语
- `tr` - 土耳其语

## 工作原理

1. **源语言**：始终以 `docs/zh/` 作为源语言
2. **文件处理规则**：
   - `.md` 文件：
     - 不存在时创建占位符文件
     - 存在但中文版本更新时间更晚时，提示需要更新
     - 存在且是最新的，跳过处理
   - 非 `.md` 文件（图片、资源文件等）：
     - 不存在或源文件更新时直接复制
     - 已是最新的则跳过
   - 多余文件/目录：
     - 目标语言中存在但中文版本中不存在的文件或目录会被自动删除
3. **特殊文件**：自动跳过 `config.ts`、`sidebar.ts` 和以 `.` 开头的文件

## 占位符内容

当创建新的 Markdown 文件时，会自动生成如下占位符内容：

```markdown
---
title: "待翻译"
description: "此页面待翻译"
source: "相对路径"
---

# 待翻译

此页面内容尚未翻译，请参考[中文版本](../../zh/相对路径)。

---

*This page is pending translation. Please refer to the [Chinese version](../../zh/相对路径).*
```

## 输出说明

脚本运行时会输出：

1. **实时操作日志**：
   - `✓ 复制: 文件路径` - 成功复制文件
   - `✓ 创建占位符: 文件路径` - 创建占位符文件
   - `✗ 删除文件: 文件路径` - 删除多余文件
   - `✗ 删除目录: 目录路径` - 删除多余目录
   - `⚠ 需要更新: 文件路径` - 文件需要更新翻译

2. **统计信息**（每个语言）：
   - 创建占位符文件数
   - 复制非MD文件数
   - 删除多余文件数
   - 需要更新翻译数
   - 已是最新数
   - 跳过数

3. **总体统计**：
   - 处理的语言总数
   - 各类操作的总计数
   - 需要更新翻译的提醒

## 注意事项

1. **不会覆盖翻译**：脚本不会覆盖已经翻译的内容，只会提示哪些文件需要更新
2. **保留本地修改**：如果目标文件的修改时间晚于中文版本，脚本会保留目标文件
3. **自动创建目录**：脚本会自动创建必要的目录结构
4. **资源文件同步**：图片等资源文件会自动从中文版本复制

## 典型工作流程

1. 运行脚本检查状态：

   ```bash
   npm run sync        # 同步所有语言
   # 或
   npm run sync:ko     # 仅同步特定语言
   ```

2. 查看输出，了解哪些文件需要更新

3. 对需要更新的文件进行翻译

4. 提交更改

## 故障排除

- **错误：中文文档目录不存在**：确保 `docs/zh/` 目录存在
- **权限问题**：确保有读写 `docs/` 目录的权限
- **Node.js 版本**：建议使用 Node.js 14.0 或更高版本

## 相关文件

- 脚本位置：`/sync-docs.js`
- 源目录：`/docs/zh/`
- 目标目录：`/docs/{语言代码}/`
