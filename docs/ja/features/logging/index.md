---
title: "ログと監査"
description: "RustFS のメトリクス、ログ収集、監査ログ、アーキテクチャの概要"
---

# ログと監査

あらゆるシステムの稼働状況やパフォーマンスを把握するには、メトリクスとログが不可欠です。RustFS は詳細なストレージ性能の監視、メトリクス、各操作のログ記録により、クラスタの状態を可視化します。これにより、オブジェクトストレージの監視・アラート・可観測性を堅牢かつ効率的に実現します。

## 機能

### 監視メトリクス

システム監視および性能メトリクスを包括的に提供します。

### ログ記録

各操作について詳細なログを記録し、監査追跡をサポートします。

## メトリクス監視

RustFS は Prometheus 互換のメトリクスエンドポイントを通じて、ハードウェア／ソフトウェアの詳細なメトリクスを幅広くエクスポートします。Prometheus は時系列データ（メトリクス名とキー／値ペア）を扱うクラウドネイティブの監視基盤であり、RustFS は Grafana による可視化ダッシュボードを提供します。Prometheus エコシステムには、RustFS のメトリクスをストレージ、メッセージング、アラートサービスへルーティングする統合が多数存在します。

RustFS はディスクやノード障害、総空き容量、ディスク単位の容量などの健全性を含む多様なメトリクスを公開します。Prometheus の広範な普及により、RustFS はサードパーティの可視化／分析／アラート向けの個別アダプタ作りではなく、オブジェクトストレージ本来の機能に集中できます。

Kubernetes 環境では、RustFS Kubernetes Operator がテナントごとの Prometheus デプロイとメトリクス収集を自動的に管理します。組織は自前の Prometheus または互換システムを各テナントに向け、複数ベンダやデータセンタ、可視化／分析ツールをまたいだ集中監視を行うことも可能です。

RustFS にはノードとクラスタの稼働を確認するためのヘルスチェックエンドポイントもあります。簡単な CURL コマンドで、対象ノードが健全か、クラスタが読み書きクォーラムを満たすかを判定できます。

## 監査ログ

RustFS の監査ログを有効化すると、クラスタ上の各操作に対して監査ログが生成されます。各操作ログには、ユニーク ID、クライアント、オブジェクト、バケット、その他関連メタデータの詳細が含まれます。RustFS はログを設定した HTTP/HTTPS Webhook エンドポイントに送信します。要件に応じ、カスタムアダプタにより監査ログの目標環境へ配送できます。

RustFS の監査ログは、RustFS コンソール UI と RustFS の `mc` CLI ツールから設定できます。Kubernetes 環境では、Operator が LogSearch との連携を備えたコンソールを自動構成し、収集された監査ログを可視化できます。

RustFS Lambda 通知により、バケットやオブジェクトのイベントをサードパーティアプリケーションへ自動送信し、イベントドリブンな処理（サーバレスや FaaS など）を可能にします。Webhook により RabbitMQ、Kafka、Elasticsearch、任意のサービスを宛先として設定できます。

RustFS コンソールおよび `mc admin trace` シェルコマンドを通じ、HTTP/S 操作のリアルタイムトレースもサポートします。

## アーキテクチャ

**RustFS は Prometheus 互換の HTTP(S) エンドポイントを通じてメトリクスを公開し、Prometheus サービスが push/pull で取得します。RustFS Kubernetes Operator はテナントごとに個別の Prometheus をデプロイしてスクレイプします。組織は集中管理の Prometheus を用いて、任意のテナントのメトリクスを収集することもできます。**

![アーキテクチャ 1](images/s7-1.png)

RustFS Lambda 通知は、Kafka、Elasticsearch、PostgreSQL などの対応先へイベントをプッシュします。管理者は S3 イベントとオブジェクトの条件フィルタを含む通知ルールをバケット単位で定義できます。通知機能は RustFS のオブジェクトストレージに組み込まれており、外部の通知先へアクセスできれば利用可能です。

![アーキテクチャ 2](images/s7-2.png)

## 要件

### メトリクス向け

BYO Prometheus、または Kubernetes Operator によりテナント単位で自動デプロイ・設定。

### LogSearch 向け

BYO PostgreSQL、または Kubernetes Operator によりテナント単位で自動デプロイ・設定。

### ログ向け

サードパーティ通知宛先をサポートします。

