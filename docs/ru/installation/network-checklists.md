---
title: "Сетевой контрольный список"
description: "Сетевой контрольный список для корпоративного развертывания RustFS"
---

# Сетевой контрольный список

## 1. Проектирование сети

### Базовое планирование
- Топология: подтвердите, что (звезда/кольцо/mesh) удовлетворяет HA требованиям распределенного хранилища
- Резервирование путей: убедитесь в наличии минимум двух независимых физических каналов между узлами
- Планирование полосы: рассчитайте ожидаемый трафик = (б/о чтения/записи × кол-во узлов × фактор репликации) + 20% запас

### IP‑планирование
- [ ] Разделение управляющей и дата‑сетей
- [ ] Выделенный непрерывный IP‑пул для узлов хранения (желательно /24)
- [ ] Резерв ≥15% адресов для масштабирования

---

## 2. Аппаратные требования
### Коммутаторы
| Проверка | Требование |
|---------|-----------|
| Backplane | ≥ суммарная линийная пропускная способность × 1.2 |
| Порты | 10G/25G/100G SFP+/QSFP+ |
| Таблицы | ≥ узлы × 5 |
| STP | Включить RSTP/MSTP с быстрой сходимостью |

### Физические соединения
- [ ] Тест затухания оптики (одномод ≤0.35 dB/km)
- [ ] Проверка соответствия порт‑к‑порту (eth0↔eth0 и т.д.)
- [ ] Система маркировки кабелей (источник/назначение IP+порт)

---

## 3. Настройки ОС
### Тюнинг ядра
```bash
# Проверьте значения
net.core.rmem_max = 16777216
net.core.wmem_max = 16777216
net.ipv4.tcp_keepalive_time = 600
net.ipv4.tcp_slow_start_after_idle = 0
```

### NIC
- [ ] Jumbo‑фреймы (MTU=9000, полная сквозная поддержка)
- [ ] Bonding/Teaming (рекомендуется LACP mode4)
- [ ] Отключить IPv6 (если не используется)

---

## 4. Безопасность
### Firewall
```bash
# Открыть необходимые порты
- TCP 443 (HTTPS API)
- TCP 9000 (S3 совместимый интерфейс)
- TCP 7946 (Serf между узлами)
- UDP 4789 (VxLAN)
```

### Доступ
- Port‑Security (MAC limits) на коммутаторах
- IPSec туннели между узлами хранилища
- TLS 1.3 для админ‑интерфейсов

---

## 5. Тесты производительности
### Бенчмарки
1. Межузловая задержка: `iperf3 -s 8972 <IP>`
2. Межстеллажная полоса: `iperf3 -c <IP> -P 8 -t 30`
3. Failover: разрыв ключевого линка и наблюдение времени восстановления

### Критерии приемки
| Метрика | Цель |
|--------|------|
| Задержка | ≤1ms (один ЦОД) / ≤5ms (между AZ) |
| Утилизация | Пик ≤70% расчетной емкости |
| Failover | <500ms сходимость BPDU |

---

## 6. Документация
1. Топология (физика+логические IP)
2. Бэкапы конфигураций коммутаторов (с отметкой времени)
3. Базовые отчеты тестов (сырые данные)
4. Журнал изменений (окна работ)

> Подсказка: перед вводом в эксплуатацию выполните 72‑часовой стресс‑тест с нагрузкой 110% от пиковых значений

Этот список покрывает ключевые контрольные точки сетевого развертывания для распределенного объектного хранилища. Для официальной поддержки обратитесь к RustFS.

