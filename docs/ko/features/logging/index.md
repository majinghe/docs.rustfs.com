# 로깅 및 감사

시스템의 상태와 성능을 추적할 때 메트릭과 로깅은 중요합니다. RustFS는 상세한 스토리지 성능 모니터링, 메트릭, 그리고 모든 작업의 로깅을 통해 클러스터에 대한 완전한 가시성을 제공합니다. 그 결과 객체 스토리지 모니터링, 경고 및 관찰 가능성에 대한 견고하고 투명하며 효율적인 답을 얻을 수 있습니다.

## 기능

### 모니터링 메트릭

완전한 시스템 모니터링과 성능 메트릭 수집을 제공합니다.

### 로깅

모든 작업에 대한 상세한 로그 정보를 기록하여 감사 추적을 지원합니다.

## 메트릭 모니터링

RustFS는 Prometheus 호환 메트릭 엔드포인트를 통해 광범위한 세분화된 하드웨어 및 소프트웨어 메트릭을 내보냅니다. Prometheus는 메트릭 이름과 키/값 쌍으로 식별되는 시계열 데이터가 있는 다차원 데이터 모델로 구성된 클라우드 네이티브 모니터링 플랫폼입니다. RustFS는 Grafana를 사용하여 수집된 메트릭을 시각화하는 스토리지 모니터링 대시보드를 포함합니다. Prometheus 생태계에는 RustFS 메트릭을 스토리지, 메시징 및 경고 서비스로 라우팅하는 여러 통합이 포함되어 있습니다.

RustFS는 디스크나 노드 장애, 총 사용 가능한 스토리지 용량, 디스크당 스토리지 용량과 같은 상태 정보를 포함하여 Prometheus 엔드포인트를 통해 다양한 세분화된 하드웨어 및 소프트웨어 메트릭을 표시합니다. Prometheus와 선도적인 메트릭 수집 및 분석 플랫폼으로서의 증가하는 인기를 활용함으로써 RustFS는 주어진 타사 분석/시각화/경고 서비스를 위한 수많은 사용자 정의 데이터 스토리지 모니터링 어댑터를 구축하는 대신 객체 스토리지 기능에 집중할 수 있습니다.

RustFS Kubernetes Operator는 각 테넌트에 대해 Prometheus 배포 및 메트릭 수집을 자동으로 배포, 구성 및 관리할 수 있습니다. 조직은 또한 여러 공급업체, 데이터 센터 및 시각화/분석 도구에 걸친 중앙 집중식 모니터링을 위해 자체 Prometheus 또는 Prometheus 호환 시스템을 각 테넌트에 지정할 수 있습니다.

RustFS는 또한 노드 및 클러스터 활성 상태를 조사하기 위한 상태 확인 엔드포인트를 제공합니다. 간단한 CURL 문으로 주어진 노드가 건강한지 또는 클러스터가 읽기/쓰기 쿼럼을 가지고 있는지 나타낼 수 있습니다.

## 감사 로그

RustFS 감사 로깅을 활성화하면 RustFS가 클러스터의 모든 작업에 대한 로그를 생성하도록 지시합니다. 각 작업은 고유 ID와 클라이언트, 객체, 버킷 및 작업과 관련된 기타 모든 메타데이터에 대한 상세한 정보를 포함하는 감사 로그를 생성합니다. RustFS는 구성된 HTTP/HTTPS 웹훅 엔드포인트에 로그 데이터를 작성합니다. 감사 로깅 대상의 특정 요구사항을 충족하기 위해 사용자 정의 어댑터를 사용할 수 있습니다.

RustFS는 RustFS 콘솔 UI와 RustFS `mc` 명령줄 도구를 통한 감사 로그 구성을 지원합니다. Kubernetes 환경의 경우, RustFS Operator는 수집된 감사 로그의 시각적 검사를 위해 LogSearch 통합으로 콘솔을 자동으로 구성합니다.

RustFS Lambda 알림은 추가 로깅 지원을 제공합니다. RustFS는 서버리스 또는 서비스형 기능 컴퓨팅 프레임워크와 같은 이벤트 기반 처리를 위해 버킷 및 객체 이벤트를 타사 애플리케이션으로 자동 전송할 수 있습니다. RustFS Lambda 알림은 RabbitMQ, Kafka, Elasticsearch 및 웹훅을 통한 임의의 서비스와 같은 대상을 지원합니다.

RustFS는 또한 RustFS 콘솔 및 RustFS mc admin trace 셸 명령을 통한 HTTP/S 작업의 실시간 추적을 지원합니다.

## 아키텍처

**RustFS는 Prometheus 호환 HTTP(S) 엔드포인트를 통해 메트릭을 노출하며, Prometheus 서비스가 이러한 메트릭에 대한 푸시/풀 액세스를 제공합니다. RustFS Kubernetes Operator는 테넌트 메트릭을 수집하기 위해 사전 구성된 각 RustFS 테넌트에 대해 독립적인 Prometheus 서비스를 배포합니다. 조직은 또한 테넌트 메트릭을 수집하기 위해 자체 중앙 집중식 Prometheus 서비스를 배포하거나 활용할 수 있습니다.**

![아키텍처 다이어그램 1](images/s7-1.png)

RustFS Lambda 알림은 Kafka, Elasticsearch 또는 PostgreSQL과 같은 지원되는 대상 서비스에 이벤트 알림을 자동으로 푸시합니다. 관리자는 RustFS가 이벤트를 생성하는 S3 이벤트 및 객체에 대한 세분화된 필터를 포함하는 버킷 수준 알림 규칙을 정의할 수 있습니다. RustFS Lambda 알림은 RustFS 객체 스토리지 서비스에 내장되어 있으며 원격 알림 대상에 대한 액세스만 필요합니다.

![아키텍처 다이어그램 2](images/s7-2.png)

## 요구사항

### 메트릭용

BYO Prometheus *또는* Kubernetes Operator를 사용하여 각 테넌트에 대해 자동으로 배포/구성하세요.

### 로그 검색용

BYO PostgreSQL *또는* Kubernetes Operator를 사용하여 각 테넌트에 대해 자동으로 배포/구성하세요.

### 로그용

타사 알림 대상에 대한 지원.